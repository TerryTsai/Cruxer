<!doctype html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <meta name='description' content='Cruxer - Social Routesetting'>
    <meta name='author' content='Terry Tsai'>
    <title>Cruxer</title>
    <link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Lato'>
    <link rel='stylesheet' type='text/css' href='css/reset.css'>
    <link rel='stylesheet' type='text/css' href='css/debug.css'>
    <link rel='stylesheet' type='text/css' href='css/common.css'>
    <link rel='stylesheet' type='text/css' href='css/global.css'>
</head>

<body>
    <div th:replace="header :: header"></div>
    <section class='clearfix'>
        <canvas id='cruxer-canvas' class='w6-10 left border-box' style="border: 1px solid black;"></canvas>
        <div class='w4-10 left border-box'>
            <form class='border-box' style="width: calc(100% - 40px)">
                <input type="text" placeholder="Search...">
            </form>
            <div id="example"></div>
        </div>
        <div class='w1-1 left border-box debug-green'></div>
    </section>
    <script src='js/jquery-2.2.1.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.min.js'></script>
    <!-- ReactJS -->
    <script src='js/react.min.js'></script>
    <script src='js/react-dom.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
    <!-- Babylon -->
    <script src='js/babylon.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/handjs/1.3.11/hand.min.js'></script>
    <script src='js/babylon.objFileLoader.js'></script>
    <script src='js/customJoystick.js'></script>
    <script src='js/customJoystickCamera.js'></script>
    <script src='js/engine.js'></script>
    <script type='text/babel' src='js/HoldView.jsx'></script>
    <script>

    </script>
    <script type='text/babel'>
        var HoldView = React.createClass({
            render: function() {
                return (
                    <h1>by {this.props.hold.account.username} {moment(this.props.hold.date).fromNow()}</h1>
                );
            }
        });

        var HoldListView = React.createClass({
            getInitialState: function() {
                return {holds : []};
            },

            render: function() {
                var hvs = this.state.holds.map(function(hold) {
                    return (<HoldView hold={hold}/>);
                });
                return (
                    <div>
                        <div>{hvs}</div>
                        <button onclick="{this.getHolds}">Load</button>
                    </div>
                );
            },

            getHolds: function() {
                console.log("Clicked");
                $.ajax({
                    url: "holds",
                    dataType: 'json',
                    success: function(data) {
                        this.setState({holds: data});
                    }.bind(this)
                });
            }
        })

        ReactDOM.render(
            <HoldListView/>,
            document.getElementById('example')
        );
    </script>
</body>

</html>
